# Bash

Bash实际上是一种脚本解释器，即一种shell执行环境

## bash中的变量

变量：内存空间的命名

内存：编址的存储单元

### bash变量类型

* 环境变量 `export varname=value` 
* 本地变量  `varname = value` 作用域为为整个bash进程，`local varname=value` 作用域为当前的代码段
* 位置变量  `$1，$2`添加到shell中的第n个参数
* 特殊变量
  * `$$` shell本身的PID
  * `$!` 最后运行线程的PID
  * `$?` 上一命令执行状态（程序的执行结果，程序返回的状态码(0-255)）
    * 0 正确
    * `1-255`执行错误，1，2，127已经被占用，其他可以自定义


* `$*` 参数列表
* `$@` 参数列表

  `shift [-n]` 轮替参数

脚本执行时会启动一个子shell进程，命令行中启动的脚本会继承当前shell环境变量

`/dev/null` 软件模拟设备

`id student &> /dev/null` 向黑洞里面输出无法得知执行结果，但是可以使用$?来判断

## 变量使用

* unset() 撤销已经创建的变量
* set 查看shell中已经存在的变量
* `peintenv`,`env`,`export`查看当前shell中的环境变量


`varname `指变量本身

`$varname` 指变量所指定的值

## bash中的条件判断

* 条件类型测试
  * 整数测试
  * 字符测试
  * 文件测试
* 条件表达式
  * `[expression]`
  * `[[expression]]`
  * test expression

### 整数比较双目运算符

* `-eq` 测试整数是否相等
* `-ne` 测试整数是否不相等
* `-gt` 测试一个数是否大于另外一个数
* `-lt` 一个数是否小于另外一个数
* `-ge` 大于或等于
* `-le` 小于等于 

### 命令逻辑

* && 
* ||

## 条件判断语法

```shell
if 判断条件; then
    语句……
fi
    
if 判断条件; then 
    语句……
else 
    语句……
fi
```

## 运算

1. `let C=$A+$B`

   ```shell
   [root@localhost ~]# A=2
   [root@localhost ~]# B=3
   [root@localhost ~]# let C=$A+$B
   [root@localhost ~]# echo $C
   5
   ```

2. `D=$[$A+$B]`

3. `C=$(($A+$B))`

4. ```
   C=`expr $A + $B`
   ```

## 提前结束结束脚本并指定状态码

定义退出状态码，不指定时，为最后一条命令的返回码

* `exit` 
* `exit n`

## 文件测试

* `-e filename ` 文件是否存在
* `-f filename` 是否是普通文件
* `-d path` 是否为目录
* `-r filename`  指定文件对当前用户的读写执行权限
* `-w`
* `-x`

`[ -e filename ]`

`[ -x filename ]`

```
if 判断语句; then
....
elif 判断语句; then
....
else
....
fi
```

### 测试脚本是否有错误

`bash -n filename`

`bash -X filename` 单步执行

## 字符比较和循环

*  `==` 是否相等，括号两边有空格`[ $A == $B ]`
* `!=` 是否不相等
* `>` 
* `<`
* `-n string` 测试指定字符串是否为空，空为真
* `-s string` 测试指定字符串不为空，空为假

### 列表生成方式

* `{1,100}` 从1和100

* `seq 10`

  ```shell
  #!/bin/bash

  for VAR in `seq 10`; do
      echo ${VAR}
  done
  ```

* `seq 5 10 ` 从5到10

* `seq 2 2 10` 偶数

* `seq 1 3 10` 

### 申明整型

* `let sum=10`
*  `declare -i sum`