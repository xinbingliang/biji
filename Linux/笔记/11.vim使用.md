# Vim使用

## 命令设置

### 显示和取消行号

* `:set number`或`:set nu` 显示行号
* `:set nonu` 取消行号

### 区分和不区分大小写

* `:set ic` 或`:set ignorecase` 忽略大小写
* `:set noignorecase` 或 `set noic` 不忽略大小写

### 自动缩进

* `:set autoindent` 或 `set ai` 自动缩进
* `:set noai` 取消自动缩进

### 查找文本高亮

* `:set hlsearch` 显示高亮
* `:set nohlsearch` 取消高亮显示

### 语法高亮

* `:syntax on` 语法高亮
* `:syntax off` 语法不高亮

root用户进入`/etc/vimrc`

```shell
set nu	#显示行号
set tabstop=4 #一个tab，4个空格
set nocompatible
set ai
set hlsearch
syntax on
set nocompatible #以非兼容模式工作，对键盘错乱有效
```

> 非root用户可以通过编辑家目录下.vimrc和.viminfo文件完成

## 打开

* `vim filename` 打开某文件
* `vim +n filename` 打开，并固定光标在第n行
* `vim +/pattern/ filename` 打开文件第一次被匹配的位置`vim +/t/ /etc/inittab`

## 模式切换

* i 光标前输入
* a 光标后输入
* o 下一行输入
* I 行前输入
* A 行末输入
* O 行上新建一行

输入模式到编辑模式 `ESC `

编辑模式到末行模式`:`

### 在末行模式下:

* `10d ` 删除第10行
* `10,20d` 10~20行删除
* `set nu` 设置行号
* `! ls ./` 执行shell命令

## 文件关闭

末行模式下

* `:w` 
* `:q`
* `wq`
* `:q!`
* `:W!` root用户强行保存
* `:x=wq`

编辑模式下

* `ZZ`保存并退出

## 光标的移动

### 逐字符

*  H 左
*  J 下
*  K 上
*  L 右
*  `nH` 左移n个字符

### 逐词移动

* W 下一个单词的首部
* E 下一个单词的尾部
* B 上一个单词的首部
* `nw` 下n个字符的首部

### 行内跳转

* 0 跳转到行首
* ^ 相对行首
* $ 绝对行尾

### 行间跳转

* `nG` 跳转到第n行
* G 到最后一行

末行模式下可以直接输入行号

## 翻屏

* `CTRL+F` 向下一屏
* `CTRL+B` 向上一屏
* `CTRL+D` 向下半屏
* `CTRL+U` 向上半屏

## 删除单个字符

* `x` 删除单个字符
* `7x` 删除7个字符

## 行删除

* `d$` 删除到行尾
* `d0` 删除到行首
* `ndw` 删除n个词到其行首
* `nde` 删除n个词到其行尾
* `ndb` 向前删除n个词
* `ndd` 向下删除n行

### 末行模式下

* `:10,20d` 
* `:.,+5d` 当前行向下5行
* `:.,100d` 当前行到100行

### 行标记

`.`当前行

`$` 最后一行

`+n` 向下n行

`$-1` 倒数第二行

## 粘贴

* p向下粘贴
* P向上粘贴

## 复制命令y(同d)

## 修改c

同d

* cc
* C$

## 替换字符

* r
* R 替换模式

## 撤销编辑

* u
* 3u
* `CTRL+R` 撤销最近一次的撤销操作

## 重复前一次操作

* `.` 

## 可视化操作

* `v` 按字符选取
* `V` 按矩形选取

## 查找替换

* `/pattern` 向下
* `?pattern` 向上
* n
* N
* `:.,$s ///` 查找替换末行模式

## 多文件编辑

`vim file1 file2`

* `:next` 切换到下一个文件
* `:prev` 切换到前一个文件
* `:last` 切换到最后一个文件
* `:first` 切换到第一个文件
* `:qa` 退出

## 分屏多文件（同时按下）

* `CTRL+W,C` 水平切分
* `CTRL+W` 换屏
* `ctrl+W,V` 垂直切分

## 多文件多窗口

* `vim -o` 水平分割显示
* `vim -O` 竖直分割显示
* `vim -o rc.sysinit initab`

## 当前文件一部分另存为另外一个文件

* `:addr1, addr2 /path`

## 将另一文件填充到当前文件中

* `:r /path`
* `:r /root/inittab`

## 和shell交互

* `:!command`

## 特殊运算

* `let SUM+=$I`
* `let I++`
* `-=`
* `let --`
* `*=`
* `/=`
* `%=`

