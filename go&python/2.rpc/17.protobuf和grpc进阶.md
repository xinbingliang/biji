# protobuf和grpc进阶

## 基本类型、默认值

* 当值不被传递时，使用默认值

* 数组的实现

  ```go
  message HelloReply {
      string message = 1;
      repeated int32 id = 2;
  }
  ```

* Python数组类型，不能先定义后赋值，可以使用数据拼接或append添加

## option go_package的作用

````
|-proto
|--common
|---stream
|----proto
````

````
//option go_package = ".;proto";
//option go_package = "common/stream/proto/v1";
option go_package = "../../common/stream/proto/v1";
````

## 当proto文件不同步的时候容易出现的问题

* 数据序列化用序列号，不是用变量名

## proto文件中引入其他的proto文件

````protobuf
// base.proto
syntax = "proto3";

//message Empty{}

message Pong{
  string id = 1;
}
````

````protobuf
// helloworld.proto
syntax = "proto3";
import "base.proto";

import "google/protobuf/empty.proto";

option go_package = ".;proto";

service Greeter {
    rpc SayHello (HelloRequest) returns (HelloReply);
    rpc Ping(google.protobuf.Empty) returns (Pong);
}
//将 sessionid放入 放入cookie中 http协议
message HelloRequest {
    string name = 1;
}

message HelloReply {
    string message = 1;
    repeated int32 id = 2;
}
````

````
from google.protobuf.empty_pb2 import Empty
````

## 嵌套的message对象

## protobuf中的enum枚举类型

## map类型









