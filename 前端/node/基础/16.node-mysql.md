# Node连接数据库

`npm install mysql --save` 安装连接包

## 连接参数

* host 主机名
* user mysql用户名
* password 密码
* database 连接数据库


## 常用方法

* client.content() 连接数据库
* client.query() 执行sql语句
* client.end() 关闭连接

## 增删改查

```javascript
var mysql = require('mysql');
var connection = mysql.createConnection({
    host: '127.0.0.1',
    user: 'root',
    password: 'root',
    database: 'demo'
});


connection.connect();

//添加记录
/*connection.query('insert into test (username, password) values ("辛丙亮", "123456")');*/
//修改记录
/*connection.query('update test set username="辛莉" where id = 2' ,function (error, rows, fields) {
    if(error){
        throw '执行失败';
    }
    console.log(rows);
});*/
//删除记录
/*connection.query('delete from test where id = "3"', function (err, rows, fields) {
    if(err){
        throw '执行失败';
    }
    console.log(rows);
});*/

//查询记录
connection.query('select * from test', function (error, rows, fields) {
    if(error){
        throw error;
    }
    if(rows){
        for(var i = 0; i < rows.length; i++){
            console.log(rows[i].id, '---', rows[i].username, rows[i].password)
        }
    }
});
```

## 连接池

```javascript
var mysql = require('mysql');
var pool = mysql.createPool({
    host: 'localhost',
    user: 'nodejs',
    password: 'nodejs',
    database: 'nodejs',
    port: 3306
});

var selectSQL = 'select * from t_user limit 10';

pool.getConnection(function (err, conn) {
    if (err) console.log("POOL ==> " + err);
e
    conn.query(selectSQL,function(err,rows){
        if (err) console.log(err);
        console.log("SELECT ==> ");
        for (var i in rows) {
            console.log(rows[i]);
        }
        conn.release();
    });
});
```

pool.escape()和pool.escape()防止sql注入



