# 浏览器端测试

## 环境搭建

* `mpm i -g mocha` 安装全局的 mocha 命令行工具
* `mocha init .`  生成脚手架，会自动创建测试框架

**index.html**

单元测试入口

* https://raw.githubusercontent.com/chaijs/chai/master/chai.js 最好保存到本地

````html
<div id="mocha"></div>
<script src='./chai.js'></script>
<script>
  var fibonacci = function (n) {
    if (n === 0) {
      return 0;
    }
    if (n === 1) {
      return 1;
    }
    return fibonacci(n-1) + fibonacci(n-2);
  };
</script>
````

**test.js**

测试用例

````javascript
var should = chai.should();
describe('simple test', function () {
  it('should equal 0 when n === 0', function () {
    window.fibonacci(0).should.equal(0);
  });
});
````

## 测试反馈

* npm i -g mocha-phantomjs

**index.html**

添加一段兼容代码

````javascript
<script>mocha.run()</script>
//改为
<script>
  if (window.initMochaPhantomJS && window.location.search.indexOf('skip') === -1) {
    initMochaPhantomJS()
  }
  mocha.ui('bdd');
  expect = chai.expect;

  mocha.run();
</script>
````

* 运行命令`mocha-phantomjs index.html --ssl-protocol=any --ignore-ssl-errors=true`

**将测试命令添加到package.json**

````javascript
"scripts": {
  "test": "mocha-phantomjs index.html --ssl-protocol=any --ignore-ssl-errors=true"
},
````

* npm i mocha-phantomjs --save-dev 添加依赖
* npm test


[travis](https://www.shiyanlou.com/courses/493/labs/1673/document) 



