# process

## exit codes

Node 执行程序正常情况下会返回 0，这也意味着，包括所有“异步”在内的操作都已结束。

* 1 未捕获的致命异常
* 2 未使用
* 3 解析错误
* 4 评估失败
* 5 致命错误
* 6 未正确的异常处理
* 7 异常处理函数运行时失败
* 8 未使用
* 9 无效的参数
* 10 运行时失败
* 12 无效的调试参数
* `>`128 信号退出

## 事件exit

````javascript
'use strict';

process.on('exit', function () {
  setTimeout(function () {
    console.log('主事件已经停止执行');
  }, 0);

  console.log('退出执行');
});
````

## signal Events

当进程接收到信号时触发。

```javascript
var i = 0
setInterval(function () {
  console.log(i);
  process.on('SIGINT', function () {
    console.log('收到 SIGINT 信号。  退出请使用 Ctrl + D ')
  })
  i++;
}, 1000);
```

## process.stdout

一个指向`标准输出流(stdout)`的 `可写的流(Writable Stream)`

````javascript
function log(d) {
  process.stdout.write(d+"\r\n");
}
log('辛丙亮');
````

## process.stderr

一个指向标准错误流(stderr)的 可写的流(Writable Stream)。

```javascript
function log(d) {
  process.stderr.write(d+"\r\n");
}
log('辛丙亮');
```

## process.stdin

一个指向 标准输入流(stdin) 的可读流(Readable Stream)。标准输入流默认是暂停 (pause) 的，所以必须要调用 process.stdin.resume() 来恢复 (resume) 接收。

````java
process.stdin.on('end', function () {
  process.stdout.write('end....');
});

function gets(cb) {
  process.stdin.resume(); //恢复接受输入
  process.stdin.setEncoding('utf8');  //设置编码
  process.stdin.on('data', function (chunk) { //接受输入
    process.stdin.pause();	//暂停
    cb(chunk);
  });
}

gets(function (result) {
  console.log("["+ result +"]");
});

````

## process.argv

一个包含命令行参数的数组。第一个元素会是 'node'， 第二个元素将是 .Js 文件的名称。接下来的元素依次是命令行传入的参数

````
process.argv.forEach(function (val, index, arr) {
  console.log(index + ":" + val);
})
````

## process.execPath 

开启当前进程的这个可执行文件的绝对路径。

应该是`node.exe`

## process.execArgv

与 `process.argv` 类似，不过是用于保存 node特殊(node-specific) 的命令行选项（参数）。

```javascript
$ node --harmony script.js --version 
```

process.execArgv 中的特殊选项:

```
['--harmony'] 
```

process.argv 接收到的参数:

```
['/usr/local/bin/node', 'script.js', '--version'] 
```

## process.abort()

这将导致 Node 触发一个abort事件，这会导致Node退出并且创建一个核心文件。

## process.chdir(directory)

改变进程的当前进程的工作目录，若操作失败则抛出异常。

## process.chdir(directory)

改变进程的当前进程的工作目录，若操作失败则抛出异常。

```javascript
console.log("当前工作目录：" + process.cwd());
try {
  process.chdir('./dist');
  console.log('新目录：' + process.cwd())
}catch (err){
  console.log('chidir：'+err)
}
```

## process.cwd()

返回进程当前的工作目录。

## process.env

一个包括用户环境的对象。

## process.exit([code])

终止当前进程并返回给定的 `code`。如果省略了 `code`，退出是会默认返回成功的状态码('success' code) 也就是 `0`。

## process.exitCode

当进程既正常退出，或者通过未指定 code 的 `process.exit()` 退出时，这个属性中所存储的数字将会成为进程退出的错误码 (exit code)。

## process.getgid()

注意： 该函数仅适用于遵循 POSIX 标准的系统平台如 Unix、Linux等 而 Windows、 Android 等则不适用。

获取进程的群组标识（详见getgid(2)）。获取到的是群组的数字ID，不是群组名称。

## process.setgid(id)

注意： 该函数仅适用于遵循 POSIX 标准的系统平台如 Unix、Linux等 而 Windows、 Android 等则不适用。

设置进程的群组标识（详见getgid(2)）。参数可以是一个数字ID或者群组名字符串。如果指定了一个群组名，这个方法会阻塞等待将群组名解析为数字ID。

## process.getgroups()

注意： 该函数仅适用于遵循 POSIX 标准的系统平台如 Unix、Linux等 而 Windows、 Android 等则不适用。

返回一个保存补充组ID(supplementary group ID)的数组。POSIX 标准没有指名 如果有效组 ID（effective group ID）被包括在内的情况，而在 node.js 中则确保它始终是。（POSIX leaves it unspecified if the effective group ID is included but node.js ensures it always is. ）

## process.setgroups(groups)

注意： 该函数仅适用于遵循 POSIX 标准的系统平台如 Unix、Linux等 而 Windows、 Android 等则不适用。

设置补充分组的ID标识. 这是一个特殊的操作, 意味着你必须拥有root或者CAP_SETGID权限才可以。（译者：CAP_SETGID表示设定程序允许普通用户使用setgid函数,这与文件的setgid权限位无关）

这个列表可以包括分组的ID表示，或分组名或两者都有。

## process.initgroups(user, extra_group)

注意： 该函数仅适用于遵循 POSIX 标准的系统平台如 Unix、Linux等 而 Windows、 Android 等则不适用。

读取 /etc/group 并且初始化group分组访问列表，使用改成员所在的所有分组， 这是一个特殊的操作, 意味着你必须拥有root或者CAP_SETGID权限才可以。

`user` 是一个用户名或者用户ID. `extra_group`是分组的组名或者分组ID。

有时候，当你在注销权限 (dropping privileges) 的时候需要注意。例如：

```javascript
console.log(process.getgroups());         // [ 0 ]
process.initgroups('bnoordhuis', 1000);   // switch user
console.log(process.getgroups());         // [ 27, 30, 46, 1000, 0 ]
process.setgid(1000);                     // drop root gid
console.log(process.getgroups());         // [ 27, 30, 46, 1000 ]
```

## process.version

一个暴露编译时存储版本信息的内置变量 `NODE_VERSION` 的属性。

## process.versions

一个暴露存储 node 以及其依赖包 版本信息的属性。

## process.config

一个包含用来编译当前 node.exe 的配置选项的对象。

## process.kill(pid, [signal])

向进程发送一个信号。

## process.pid

当前进程的 PID

## process.title

获取/设置 (Getter/setter) 'ps' 中显示的进程名。

## process.arch

返回当前 CPU 处理器的架构：'arm'、'ia32' 或者 'x64'.

## process.platform

返回当前程序运行的平台：`'darwin'`, `'freebsd'`, `'linux'`, `'sunos'` 或者 `'win32'`

## process.memoryUsage()

返回一个对象，它描述了Node进程的内存使用情况单位是bytes。

## process.nextTick(callback)

- `callback` {Function}

在事件循环的下一次循环中调用 callback 回调函数。

```javascript
console.log('开始');
process.nextTick(function () {
  console.log('nextTick 回调');
});
console.log('已设定');
```

## process.umask([mask])

设置或者读取进程的文件模式的创建掩码。

## process.uptime()

返回 Node 程序已运行的秒数

## process.hrtime()

返回当前的高分辨时间，形式为 `[秒，纳秒]` 的元组数组。它是相对于在过去的任意时间。该值与日期无关，因此不受时钟漂移的影响。主要用途是可以通过精确的时间间隔，来衡量程序的性能。

你可以将前一个 `process.hrtime()` 的结果传递给当前的 `process.hrtime()` 函数，结果会返回一个比较值，用于基准和衡量时间间隔。

