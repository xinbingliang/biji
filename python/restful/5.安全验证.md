# 安全验证

## 使用安全校验

### 配置

* `BasicAuthentication`
* `TokenAuthentication`
* `SessionAuthentication`

````python
REST_FRAMEWORK = {
    'DEFAULT_AUTHENTICATION_CLASSES': (
        'rest_framework.authentication.BasicAuthentication',
        'rest_framework.authentication.SessionAuthentication',
        'rest_framework.authentication.TokenAuthentication', # token验证的方式
    )
}
````

````python
INSTALLED_APPS = (
    ...
    'rest_framework.authtoken'
)
````

* `python3 manage.py makemigrations`
* `python3 manage.py migrate`

```python
# settings.py
from rest_framework.authtoken import views
urlpatterns = [
	....
    path('api-token-auth/', views.obtain_auth_token),
]
```

### 为用户创建token

用户注册时去创建

#### 测试

```
username:
password: 
```

#### 返回

```python
{
    "token": "077494faa029de492c5585abbc029b40c53383dd"
}
```

* 即便在创建时没有主动创建也会在在请求后创建

#### 使用

在HTTP header提交请求时携带

```
Authorization: Token 077494faa029de492c5585abbc029b40c53383dd
```

* 会将验证信息放到`request.auth`中
* 会将用户信息放到`request.user`中